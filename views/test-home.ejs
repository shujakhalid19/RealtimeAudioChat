<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

        <!-- jQuery library -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    
        <!-- Latest compiled JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script src="https://kit.fontawesome.com/c939d0e917.js"></script>
        <link rel="stylesheet" href="../ui.css">
        <link rel="stylesheet" href="../select.css">
        <link rel="stylesheet" href="../snackbar.css" />
        <script src="../select.js" defer></script>
 
        <style>

        a{
            color: inherit;
        }

        .cl{
            color:aqua;
        }

        .btn:focus{
            outline: none;
        }

              input{
            border:none;
            width: 90%;
        }

        .btn-silent {
            background-color: #404040;
        }    

        .btn-silent:hover{
            background-color: #313131;
            color:#fff;
        }

        input:focus{
            outline:none;
        }

        .bs-docs-sidenav>li>a:hover{
          background-color: #202020;  
          color:inherit
        }

        .notification-bottom {
  position: fixed;
  width: 100%;
  bottom: 0;
  left: 0;
  /* Rest of your styling */
}

.notification-close {
  position: absolute;
  right: 5px;
  top: 5px;
  /* This are approximated values, and the rest of your styling goes here */
}
        </style>
    
</head>
<body>
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12 hidden-md hidden-sm hidden-lg">
                    <div class="md-btm-20">
                        <div class="md-btm-20"></div>
                        <div class="f-20 b pd-top-20 pull-left">LOGO</div>
                            <div class="pull-right">
                                
                                <button class="btn btn-md btn-silent" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                &nbsp;
                                <a href="#gallery"><button class="btn btn-md btn-silent "><i class="fa fa-bell" aria-hidden="true"></i></button></a>
                                &nbsp;
                                
                                <a href="/profile/@me"><img src="https://images.unsplash.com/photo-1619796404374-aff912b43cd2?ixid=MnwxMjA3fDB8MHxlZGl0b3JpYWwtZmVlZHwxMnx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/></a>
                                
                            </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 col-md-3 pd-lt-20 hidden-xs">
                    <div class="md-btm-20"></div>
                    <h3 class=""><div class="pd-top-20 pull-left">LOGO</div>
                        <div class="pull-right">
                            <div class="f-17 hide" style="display: inline-block;margin: 15px 20px 0px 0px;"><i class="fa fa-plus"></i></div>
                            <a href="/profile/@me"><img src="https://images.unsplash.com/photo-1619796404374-aff912b43cd2?ixid=MnwxMjA3fDB8MHxlZGl0b3JpYWwtZmVlZHwxMnx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/></a>
                        </div>
                        
                        
                    </h3>

                    <div class="col-xs-12 col-sm-12 col-md-12 pd-0">
                        <nav class="md-top-20">
                            <br>
                            <ul class="nav b bs-docs-sidenav f-15" style="line-height: 35px;">
                              <li class=""> <a href="explore.php"><i class="fa fa-home"></i>&nbsp;&nbsp;Home</a></li>
                              <li class=""> <a href="search.php"><i class="fa fa-hashtag"></i>&nbsp;&nbsp;Search</a></li>
                              <li class=""> <a href="search.php"><i class="fa fa-globe"></i>&nbsp;&nbsp;World</a></li>
                              <li class=""> <a href="#btn-groups"><i class="fa fa-fire"></i>&nbsp;&nbsp;Popular</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-7 col-md-6 pd-10">
                    <div class="md-btm-30"></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 pd-0 md-top-40">
                        <form id="search_form" method="POST">
                            <div class="pd-10 bg-grey" style="width:100%; position:absolute;top:auto;bottom:10px;border-radius:4px;">
                                <input id="srch" name="search" type="text" placeholder="Search rooms.." style="background-color: transparent; color:#fff;;">
                                <span id="srch_icon" class="pd-5 pull-right fa fa-search"></span>
                            </div>
                        </form>
                    </div>

                    <!-- ROOMS -->
                    <div id="rooms" class="col-xs-12 col-sm-12 col-md-12 md-top-20">
                        <div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark bd-curve-14 md-top-30">
                            <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-30">
                                <h5 class="col-xs-10 col-sm-10 col-md-10 pd-0"> 
                                    <div class="md-btm-10 b">Discussion Name</div>
                                    <div class="md-btm-20 f-12">with @shuja and 12 others</div>
                                    <span class="btn btn-xs btn-silent">Science</span>
                                    <span class="btn btn-xs btn-silent"><i class="fa fa-headphones-alt"></i></span>
                                </h5>

                                <div class="col-xs-2 col-sm-2 col-md-2 pd-10">
                                    <button class="btn btn-sm btn-success pull-right">Join</button>
                                </div>
                                <p class="col-xs-12 col-sm-12 col-md-12 pd-0 pd-top-10 f-12 text-muted">
                                    Lorem Ipsum is simply dummy text of the printing and typesetting industry. 
                                </p>
                                <div class="pull-right">
                                    
                                </div>
                                <br/>
                            </div>
                        </div>

                    </div>
                    
                    <div id="rooms" class="col-xs-12 col-sm-12 col-md-12 md-top-20">
                        <div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark bd-curve-14 md-top-30">
                            <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-30">
                                <h5 class="col-xs-10 col-sm-10 col-md-10 pd-0"> 
                                    <div class="md-btm-10 b">Discussion Name</div>
                                    <div class="md-btm-20 f-12">with @shuja and 12 others</div>
                                    <span class="btn btn-xs btn-silent">Science</span>
                                    <span class="btn btn-xs btn-silent"><i class="fa fa-headphones-alt"></i></span>
                                </h5>

                                <div class="col-xs-2 col-sm-2 col-md-2 pd-10">
                                    <button class="btn btn-sm btn-success pull-right">Join</button>
                                </div>
                                <p class="col-xs-12 col-sm-12 col-md-12 pd-0 pd-top-10 f-12 text-muted">
                                    Lorem Ipsum is simply dummy text of the printing and typesetting industry. 
                                </p>
                                <div class="pull-right">
                                    
                                </div>
                                <br/>
                            </div>
                        </div>

                    </div>
                    
                    <!-- //ROOMS -->
                </div>

                <div class="col-xs-12 col-sm-3 col-md-3 hidden-sm hidden-xs">
                    <div class="md-btm-30"></div>
                    <div class="">
                        <button class="btn btn-md btn-silent"><i class="fa fa-comment-alt" aria-hidden="true"></i></button>
                        &nbsp;&nbsp;&nbsp;
                        <a href="#gallery">
                            <button class="btn btn-md btn-silent "><i class="fa fa-bell" aria-hidden="true"></i></button>
                        </a>
                        &nbsp;&nbsp;&nbsp;
                        <button class="btn btn-md btn-silent " type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus" aria-hidden="true"></i> New Room</button>
                    </div>
                </div>
            </div>

        </div>

                            <!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
  
      <!-- Modal content-->
      <div class="modal-content bg-grey">
        <div class="modal-header">
          <!-- <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
          <h4 class="modal-title">Modal Header</h4> -->
            <div class="col-xs-12 col-sm-12 col-md-12 pd-0" style="display: flex;">

                <h4 class="b">New Group</h4>
                <div style="margin-left: auto;">
                    <button id="newsub" type="submit" form="Topic" class="btn btn-md btn-silent">Create</button>
                </div>
            </div>  
            
            
        </div>
        <div class="modal-body">
            <form id="Topic" method="POST" autocomplete="off" style="color:#fff;">
                <div class="form-group">
                                     <div class="err hide alert alert-success">
                                       Price not updated!!
                                     </div>
                                     <div class="done hide alert alert-success">
                                       Prices updated successfully!!
                                     </div>
                                    <div style="color:#999;padding-bottom:10px;" class="b md-top-20">Title</div>
                                       <input id="topic_name" type="text" name="title" placeholder="Title" class="form-control bg-input" style="height:40px;" required/>
                                       <span class="errFirst four f-12 hide cl-red">Field cannot be left empty!</span>
                                   </div>

                          <div style="margin-bottom:20px">
                               <div style="color:#999;padding-bottom:10px;" class="b">Category</div>
                               <div class="custom-select" style="width:100%;">
                                  <select name='language'>
                                      <option value="0">Public Figure</option>
                                      <option value="1">Public Figure</option>
                                      <option value="2">Object</option>
                                      <option value="3">Place</option>
                                      <option value="4">Product</option>
                                      <option value="5">Software</option>
                                      <option value="6">Other</option>
                                  </select>
                                  </div>

                           </div>



                           <div style="margin-bottom:20px">
                               <div style="color:#999;padding-bottom:10px;" class="b">About</div>
                               <textarea class="form-control bg-input" name="about" placeholder=""></textarea>
                           </div>


                           
                       </form>
        </div>
        
      </div>
  
    </div>
  </div>
  <!-- //MODAL -->

  <style>
            
    /* The side navigation menu */

.sidenav {

height: 100%; /* 100% Full-height */

width: 0; /* 0 width - change this with JavaScript */

position: fixed; /* Stay in place */

z-index: 99999999; /* Stay on top */

top: 0; /* Stay at the top */

left: auto;

right:0;

background-color: #fff; /* Black*/

overflow-x: hidden; /* Disable horizontal scroll */

padding-top:0px; /* Place content 60px from the top */

transition: 0.5s; /* 0.5 second transition effect to slide in the sidenav */



}



/* The navigation menu links */

.sidenav a {

padding: 8px 8px 8px 0px;

text-decoration: none;

font-size: 25px;

color: #818181;

display: block;

transition: 0.3s;

}



/* When you mouse over the navigation links, change their color */

.sidenav a:hover {

color: #f1f1f1;

}



/* Position and style the close button (top right corner) */

.sidenav .closebtn {

left:0px;

font-size: 22px;



}



/* Style page content - use this if you want to push the page content to the right when you open the side navigation */

#main {

transition: margin-left .5s;

padding: 20px;

}


/* GALLERY CSS */
#overlay {
position: fixed; /* Sit on top of the page content */
display: none; /* Hidden by default */
width: 35%;/* Full width (cover the whole page) */
height: 100vh; /* Full height (cover the whole page) */
top: 0;
left: auto;
right: 0;
bottom: 0;
background-color: #111; /* Black background with opacity */
z-index: 999; /* Specify a stack order in case you're using a different order for other elements */
cursor: pointer; /* Add a pointer on hover */
overflow-y:auto;

}

/* Extra small devices (phones, 600px and down) */
@media only screen and (max-width: 600px) {
#overlay{
width:100%;
}
}



    



/* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */

@media screen and (max-height: 450px) {

.sidenav {padding-top: 15px;}

.sidenav a {font-size: 18px;}

}

 

</style>
  <!-- Gallery -->
<div id="overlay" class="bd pd-0">
    <h3 class="col-xs-12 pd-0 fixed" style="background: #141414; width:100%;top:-10px;height:40px;padding:10px 15px 0px 0px;">
        <div class="pull-left">
            &nbsp; Notifications
        </div>
        <a href="javascript: window.history.back();" style="text-decoration: none;color:inherit;">
            <div class="pull-right">
                <i class="fa fa-times"></i>
            </div>
        </a>
    </h3>
    
    <div class="col-xs-12 col-xs-12 col-md-12 md-top-20" style="padding:0px;margin-bottom:20px;">
        <div class="col-xs-12 col-md-12 md-top-20 md-rt-10">
            <div class="col-xs-12 col-sm-12 col-md-12 pd-0 md-btm-40" style="display: flex;">
                <img src="https://picsum.photos/id/23/200/300" class="prof" style="width: 40px;height: 40px;">
                <div class="pd-lt-10">Group
                    <div class="text-muted f-12">Followed you</div>
                </div>
                <div style="margin-left: auto;">
                    <button class="btn btn-md btn-pill"><i class="fa fa-plus" aria-hidden="true"></i> Follow</button>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-md-12 md-top-20 md-rt-10">
            <div class="col-xs-12 col-sm-12 col-md-12 pd-0 md-btm-40" style="display: flex;">
                <img src="https://picsum.photos/id/23/200/300" class="prof" style="width: 40px;height: 40px;">
                <div class="pd-lt-10">Group
                    <div class="text-muted f-12">Followed you</div>
                </div>
                <div style="margin-left: auto;">
                    <button class="btn btn-md btn-pill"><i class="fa fa-plus" aria-hidden="true"></i> Follow</button>
                </div>
            </div>
        </div>
                    
    </div>
    </div>
    <!-- //Gallery -->
    


<div id="snackbar">Log in to vote</div>
</body>
<script src="../client.js"></script>
<script>
    var d=new Date();
    $(function(){
        $('#srch').keypress(function (e) {
            if (e.which == 13) {
                $('form#search_form').submit();
                $('#srch_icon').on('click',get_rooms);
                $('#srch_icon').removeClass('fa-search').addClass('fa-times');

                return false;    //<---- Add this line
            }
        });

        $('form#search_form').on('submit',function(e){
            e.preventDefault();
            var formData = $(this);
            $.ajax({
                type:"POST",
                url:"/search",
                data:formData.serialize() + '&' + $.param({
                  'time': d.getTime()
                }),
                success:function(data){
                    let h="";
                    if(!data.state){
                        h=`<div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bd-curve-14 md-btm-40 text-center">
                                <h3>No results found</h3>
                                <small>Try searching something else.
                            </div>`;
                    }else{
                        console.warn(data);
                        $.each(data.rooms,function(key,index){
                            //console.warn(index);    
                            h+=`<div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark bd-curve-14 md-btm-40">
                                        <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-30">
                                            <h5 class="col-xs-10 col-sm-10 col-md-11 pd-0"> 
                                                <div class="md-btm-10">`+index.name+`</div>
                                                <span class="btn btn-xs btn-silent">`+index.language+`</span>
                                            </h5>
                                            <div class="col-xs-2 col-sm-2 col-md-1 pd-top-10-lt-5">
                                                <a href="voice/`+index.roomId+`"><button class="btn btn-sm btn-success">Join</button></a>
                                            </div>
                                            <p class="col-xs-12 col-sm-12 col-md-12 pd-0 pd-top-10 f-12 text-muted">
                                                `+index.about+`
                                            </p>
                                            <div class="col-xs-12 col-sm-12 col-md-12 pd-0 f-10 text-danger pd-top-10">
                                                <a href="profile/`+index.creatorId+`">
                                                    <img src="https://picsum.photos/id/`+index.creatorId+`/200/300" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/>
                                                </a>
                                            </div>
                                            <div class="pull-right">
                                                
                                            </div>
                                            <br/>
                                        </div>
                                    </div>`;
                        })
                    }        
                    $("#rooms").html(h);
                }
            });
            
        });

        get_rooms();

        $('#Topic').on('submit',function(e){
            e.preventDefault();
            var formData = $(this);
            $.ajax({
                type:"POST",
                url:"/newroom",
                data:formData.serialize() + '&' + $.param({
                  'time': d.getTime()
                }),
                success:function(data){
                    
                    if (data.err) {
                        $(".err").removeClass('hide');
                    }else{
                        $(".done").removeClass('hide');
                        $('#myModal').modal('hide');
                        $("#rooms").prepend(`<div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark bd-curve-14 md-btm-30">
                            <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-30">
                                <h5 class="col-xs-10 col-sm-10 col-md-10 pd-0"> 
                                    <div class="md-btm-10">`+data.result.title+`</div>
                                    <span class="btn btn-xs btn-silent">`+data.result.language+`</span>
                                </h5>
                                <div class="col-xs-2 col-sm-2 col-md-2">
                                    <img src="https://images.unsplash.com/photo-1619796404374-aff912b43cd2?ixid=MnwxMjA3fDB8MHxlZGl0b3JpYWwtZmVlZHwxMnx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" class="prof pull-right" style="width:40px;height:40px;border:2px solid cornflowerblue;"/>
                                </div>
                                <p class="col-xs-12 col-sm-12 col-md-12 pd-0 pd-top-10 f-12 text-muted">
                                    Lorem Ipsum is simply dummy text of the printing and typesetting industry. 
                                </p>
                                <div class="pull-left f-10 text-danger pd-top-10">
                                    12 out of 15
                                </div>
                                <div class="pull-right">
                                    <button class="btn btn-sm btn-success">Join</button>
                                </div>
                                <br/>
                            </div>
                        </div>`);
                    }

                    console.log(data);
                }
            });
        });
    })

    
    function get_rooms(){
        let h='';
        $.ajax({type:"POST",url:'/pop_rooms',data:{_token:'_token'},success:function(data){
            $.each(data,function(key,index){
                //console.warn(index);    
                /*h+=`<div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark bd-curve-14 md-btm-40">
                            <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-30">
                                <h5 class="col-xs-10 col-sm-10 col-md-11 pd-0"> 
                                    <div class="md-btm-10">`+index.name+`</div>
                                    <span class="btn btn-xs btn-silent">Science</span>
                                    <span class="btn btn-xs btn-silent"><i class="fa fa-user"></i> Active 23</span>
                                </h5>
                                <div class="col-xs-2 col-sm-2 col-md-1 pd-top-10-lt-5">
                                    <button class="btn btn-sm btn-success" onclick="join_room(&apos;`+index.ultraId+`&apos;)">Join</button>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-12 pd-0 f-10 text-danger pd-top-10">
                                    <a href="profile/`+index.creatorId+`">
                                        <img src="https://picsum.photos/id/`+index.creatorId+`/200/300" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/>
                                    </a>
                                    <a href="profile/`+index.creatorId+`">
                                        <img src="https://picsum.photos/id/`+index.creatorId+`/200/300" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/>
                                    </a>
                                    <a href="profile/`+index.creatorId+`">
                                        <img src="https://picsum.photos/id/`+index.creatorId+`/200/300" class="prof" style="width:40px;height:40px;border:2px solid cornflowerblue;"/>
                                    </a>

                                </div>
                                <div class="pull-right">
                                    
                                </div>
                                <br/>
                            </div>
                        </div>`;*/
                        h+=`<div class="col-xs-12 col-sm-12 col-md-12 bd-btm pd-10 bg-dark md-btm-40">
                        
                            <div class="col-xs-12 col-sm-9 col-md-12 pd-0 md-btm-10">
                                <h5 class="col-xs-10 col-sm-10 col-md-10 pd-0"> 
                                    <div class="md-btm-10 b">`+index.name+`</div>
                                    <div class="md-btm-20 f-12">with <a class="cl" href="profile/`+index.creatorId+`">@`+index.username+`</a> and 12 others</div>
                                    <span class="btn btn-xs btn-silent">`+index.language+`</span>
                                    <span class="btn btn-xs btn-silent"><i class="fa fa-headphones-alt"></i></span>
                                </h5>

                                <div class="col-xs-2 col-sm-2 col-md-2 pd-10">
                                    <button class="btn btn-sm btn-success pull-right" onclick="join_room(&apos;`+index.ultraId+`&apos;,this)">Join</button>
                                </div>
                                <p class="col-xs-12 col-sm-12 col-md-12 pd-0 pd-top-10 f-12 text-muted">
                                    `+index.about+`
                                </p>
                                <br/>
                            </div>
                        </div>`;
            })
            $("#rooms").html(h);
            $('#srch_icon').off('click');
            $("#srch").val('');
            $('#srch_icon').removeClass('fa-times').addClass('fa-search');
        }})
    }
    
</script>
<script>
        
    //history.pushState("", document.title, window.location.pathname+ window.location.search);

    
    
     if (window.history && window.history.pushState) {

    //if (window.history.pushState) {
          
          var flag=true;  
          var ftype;         

          $(window).on('popstate', function () {
              var type=window.location.hash.substr(1);
              if(flag){
                  
                  console.log(type);
                  switch(type){
                      case 'modal':
                          ftype=type;
                          openNav();
                          break;
                      case 'gallery':
                          ftype=type;
                          on();
                         break;
                  }
                  
              }else{
                  console.log('close'+ftype);
                  switch(ftype){
                      case 'modal':
                         closeNav();
                         break;
                      case 'gallery':
                         off();
                         break;
                  }
                  
              }

              flag=!flag;

          });

      }

    

    

 function myFunction(x,call) {
     
    if (x.matches) { // If media query matches

         var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;

          call(width);

    } else {

          call('md');

    }

  }



var x = window.matchMedia("(max-width: 700px)");
  
    

function openNav() {
         //alert('ASDASD');

    myFunction(x,function(size){

            

            if(size=='md'){

              document.getElementById("mySidenav").style.width = "550px";

            }else{

                document.getElementById("mySidenav").style.width = size+"px";            

            }

          

        });

    

    $('body').css('overflow','hidden');



        

}



/* Set the width of the side navigation to 0 */

function closeNav() {

  $('body').css('overflow','auto');

  $('body').css('position','static');

  document.getElementById("mySidenav").style.width = "0";

}

function on() {
  //history.pushState("on", document.title, window.location.pathname+ window.location.search);
  //window.location.href="#on";
  $('body').css('overflow','hidden');
document.getElementById("overlay").style.display = "block";
}

function off() {
$('body').css('overflow','auto');

  
document.getElementById("overlay").style.display = "none";
}

    
</script>

</html>